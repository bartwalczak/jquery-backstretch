/*
 * jQuery Backstretch
 * Version 1.2.5
 * http://srobbin.com/jquery-plugins/jquery-backstretch/
 *
 * Add a dynamically-resized background image to the page
 *
 * Copyright (c) 2011 Scott Robbin (srobbin.com)
 * Dual licensed under the MIT and GPL licenses.
 *
 * modified 2011-12-01 by Bartlomiej Walczak (feniks@akcja.pl)
 * added fitWidth and fitHeight options and relevant code
*/

(function(a){a.backstretch=function(b,c,d){function s(b){try{o={left:0,top:0};if(q>=i.height()||p>=i.width()){m=i.height();l=m*j;if(l>i.width()){l=i.width();if(g.fitWidth){p=l;q=p/j;n=(m-q)/2;if(g.centeredY)a.extend(o,{top:n+"px"})}else if(g.fitHeight&&!g.fitWidth){q=m;p=q*j;l=i.width();n=(p-l)/2;if(g.centeredX)a.extend(o,{left:"-"+n+"px"})}else{if(q>m){n=(q-m)/2;if(g.centeredY)a.extend(o,{top:"-"+n+"px"})}else{n=(m-q)/2;if(g.centeredY)a.extend(o,{top:n+"px"})}n=(p-l)/2;if(g.centeredX)a.extend(o,{left:"-"+n+"px"})}}else{l=i.width();if(g.fitHeight){q=m;p=q*j;n=(l-p)/2;if(g.centeredX)a.extend(o,{left:n+"px"})}else if(g.fitWidth&&!g.fitHeight){l=i.width();p=l;q=p/j;n=(m-q)/2;if(g.centeredY)a.extend(o,{top:n+"px"})}else{n=(q-m)/2;if(g.centeredY)a.extend(o,{top:"-"+n+"px"});n=(p-l)/2;if(g.centeredX)a.extend(o,{left:"-"+n+"px"})}}}else{q=i.height();p=q*j;m=q;l=i.width();n=(p-l)/2;if(g.centeredX)a.extend(o,{left:"-"+n+"px"})}a("#backstretch").width(l).height(m);a("#backstretch img:not(.deleteable)").width(p).height(q).css(o)}catch(c){}if(typeof b=="function")b()}function r(){if(b){var c;if(f.length==0){f=a("<div />").attr("id","backstretch").css({left:0,top:0,position:"fixed",overflow:"hidden",zIndex:-999999,margin:0,padding:0,height:"100%",width:"100%"})}else{f.find("img").addClass("deleteable")}c=a("<img />").css({position:"absolute",display:"none",margin:0,padding:0,border:"none",zIndex:-999999}).bind("load",function(b){var c=a(this);c.css({width:"auto",height:"auto"});p=this.width||a(b.target).width();q=this.height||a(b.target).height();j=p/q;s(function(){c.fadeIn(g.speed,function(){f.find(".deleteable").remove();if(typeof d=="function")d()})})}).appendTo(f);if(a("body #backstretch").length==0){a("body").append(f)}f.data("settings",g);c.attr("src",b);a(window).resize(s)}}var e={centeredX:true,centeredY:true,speed:0,fitHeight:false,fitWidth:true},f=a("#backstretch"),g=f.data("settings")||e,h=f.data("settings"),i="onorientationchange"in window?a(document):a(window),j,k,l,m,n,o,p,q;if(c&&typeof c=="object")a.extend(g,c);if(c&&typeof c=="function")d=c;a(document).ready(r);return this}})(jQuery)